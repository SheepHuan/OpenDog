(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be9ebd0a"],{1252:function(e,t,s){"use strict";s("9412")},"887c":function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"reset-container"},[s("div",{staticClass:"form-container"},[s("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[s("el-step",{attrs:{title:"身份验证"}}),s("el-step",{attrs:{title:"密码重置"}}),s("el-step",{attrs:{title:"重置完成"}})],1),2!=e.active?s("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"100px"}},[0==e.active?s("div",{staticClass:"form-box"},[s("el-form-item",{attrs:{label:"账号",prop:"username"}},[s("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[s("el-input",{on:{input:e.resetType},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),s("el-button",{staticClass:"checkbtm",attrs:{type:"success",icon:e.iconType[e.typeIndex],circle:""},on:{click:e.checkUsername}})],1)]),s("el-form-item",{attrs:{label:"密码问题"}},[e._v(" "+e._s(e.form.question)+" ")]),s("el-form-item",{attrs:{label:"问题答案",prop:"answer"}},[s("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkAnswer(t)}},model:{value:e.form.answer,callback:function(t){e.$set(e.form,"answer",t)},expression:"form.answer"}})],1)],1):e._e(),1==e.active?s("div",{staticClass:"form-box"},[s("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("div",{staticStyle:{display:"flex"}},[s("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:function(t){return e.checkCapslock(t)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),s("span",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.showPwd("password")}}},[s("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1)])],1),s("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[s("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[s("el-input",{key:e.passwordType,ref:"checkPass",attrs:{type:e.passwordType,placeholder:"确认密码",name:"checkPass",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.resetPass("form")}]},model:{value:e.form.checkPass,callback:function(t){e.$set(e.form,"checkPass",t)},expression:"form.checkPass"}})],1)],1)],1):e._e(),s("el-form-item",[0==e.active?s("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.checkAnswer}},[e._v(" 下一步 ")]):e._e(),1==e.active?s("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.resetPass("form")}}},[e._v(" 下一步 ")]):e._e()],1)],1):e._e(),2==e.active?s("div",{staticClass:"form-box"},[s("el-result",{attrs:{icon:"success",title:"密码重置成功",subTitle:"请返回登录界面"}},[s("template",{slot:"extra"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.returnLogin}},[e._v("返回")])],1)],2)],1):e._e()],1)])},r=[],a=(s("d9e2"),s("498a"),s("bd11"),{data:function(){var e=this,t=function(t,s,o){""===s?o(new Error("请输入密码")):(""!==e.form.checkPass&&e.$refs.form.validateField("checkPass"),o())},s=function(t,s,o){""===s?o(new Error("请再次输入密码")):s!==e.form.password?o(new Error("两次输入密码不一致!")):o()};return{form:{username:"",question:"",answer:"",password:"",checkPass:""},typeIndex:0,passwordType:"password",capsTooltip:!1,loading:!1,showDialog:!1,redirect:void 0,otherQuery:{},active:0,iconType:["el-icon-search","el-icon-check","el-icon-close"],rules:{username:[{requird:!0,message:"用户名不能为空",trigger:"blur"}],question:[{required:!0,message:"请输入密码问题",trigger:"blur"}],answer:[{required:!0,message:"请输入问题答案",trigger:"blur"}],password:[{validator:t,trigger:"blur"}],checkPass:[{validator:s,trigger:"blur"}]}}},methods:{checkCapslock:function(e){var t=e.key;this.capsTooltip=t&&1===t.length&&t>="A"&&t<="Z"},showPwd:function(e){var t=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){t.$refs[e].focus()}))},checkUsername:function(){var e=this;""!=this.form.username.trim()&&(console.log(this.form.username),this.$store.dispatch("user/getQuestion",this.form.username).then((function(t){console.log("res",t);var s=t.stateCode,o=t.question;1e3==s?(e.form.question=o,e.typeIndex=1):e.typeIndex=2})).catch((function(){e.loading=!1})))},resetType:function(){this.form.question="",this.typeIndex=0},checkAnswer:function(){var e=this;this.loading=!0,this.$store.dispatch("user/checkAnswer",this.form).then((function(t){2e3==t?(e.active++,e.loading=!1):(e.$alert("提交失败","提示",{confirmButtonText:"确定",callback:function(){e.$message({type:"error",message:"问题答案错误"})}}),e.loading=!1)}))},resetPass:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$alert("提交失败","提示",{confirmButtonText:"确定",callback:function(){t.$message({type:"error",message:"密码错误"})}}),!1;t.loading=!0,t.$store.dispatch("user/resetPass",t.form).then((function(e){1e3==e?(t.active++,t.loading=!1):t.loading=!1})).catch((function(){t.loading=!1}))}))},returnLogin:function(){this.$store.dispatch("user/resetToken"),this.$router.push({path:"/login"})}}}),n=a,i=(s("1252"),s("2877")),c=Object(i["a"])(n,o,r,!1,null,"4f71589c",null);t["default"]=c.exports},9412:function(e,t,s){}}]);